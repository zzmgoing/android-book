# 四大引用类型

>从Java SE2开始，就提供了四种类型的引用：**强引用**、**软引用**、**弱引用**和**虚引用**。

Java中提供这四种引用类型主要有两个目的：  
第一是可以让程序员**通过代码的方式决定某些对象的生命周期；**  
第二是**有利于JVM进行垃圾回收**。

| 类别 | 回收机制 | 用途 | 生存时间 |
| --- | --- | --- | --- |
| 强引用 | 从不回收 | 对象状态 | JVM停止运行时|
| 软引用 | 内存不足时回收 | 缓存 | 内存不足 |
| 弱引用 | 对象不被引用时回收 | 缓存 | GC运行后 |
| 虚引用 | 对象被回收时 | 管理控制精确内存稳定性 | unknown |

**一、强引用（StrongReference）**

**一个对象若持有强引用，垃圾回收器绝不会回收它**。当内存空间不足，Java虚拟机宁愿抛出OutOfMemoryError错误，使程序异常终止，也不会靠随意回收具有强引用的对象来解决内存不足的问题。

①强引用可以直接访问目标对象。  
②强引用所指向的对象在任何时候都不会被系统回收。JVM宁愿抛出OOM异常，也不会回收强引用所指向的对象。  
③强引用可能导致内存泄露。

**二、软引用（SoftReference）**

如果一个对象持有软引用，那么如果内存空间足够，垃圾回收器就不会回收它；**如果内存空间不足了，就会回收这些对象的内存**。

①软引用可用来实现内存敏感的高速缓存。  
②通过软引用的get()方法，取得对象实例的强引用，GC在内存充足的情况下，不会回收软引用对象。  
③一旦GC回收Java对象之后，get()方法将返回null，在获取软引用对象的代码中需要判断是否为null。

**三、弱引用（WeakReference）**

如果一个对象持有弱引用，那么在垃圾回收器线程扫描的过程中，一旦发现了只具有弱引用的对象，**不管当前内存空间足够与否，都会回收它的内存**。

①只具有弱引用的对象拥有更短暂的生命周期，可能随时被回收。  
②只具有软引用的对象只有当内存不够的时候才被回收，在内存足够的时候，通常不被回收。

**四、虚引用（PhantomReference）**

虚引用是所有引用类型中最弱的一个。  
一个持有虚引用的对象，和没有引用几乎是一样的，随时都可能被垃圾回收器回收。当试图通过虚引用的get()方法取得强引用时，总是会失败。并且，虚引用必须和引用队列一起使用，它的作用在于跟踪垃圾回收过程。